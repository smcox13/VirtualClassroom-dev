{"ast":null,"code":"import _classCallCheck from\"/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import readXlsxFile from'read-excel-file';import{Button}from'@momentum-ui/react';import{Redirect}from'react-router-dom';import Header from'./Header.js';var FileUpload=/*#__PURE__*/function(_React$Component){_inherits(FileUpload,_React$Component);var _super=_createSuper(FileUpload);function FileUpload(props){var _this;_classCallCheck(this,FileUpload);_this=_super.call(this,props);_this.state={uploadedFile:null,studentList:null,lastIndex:1};_this.fileRef=React.createRef();_this.uploadClicked=_this.uploadClicked.bind(_assertThisInitialized(_this));_this.onSelectFile=_this.onSelectFile.bind(_assertThisInitialized(_this));_this.saveClick=_this.saveClick.bind(_assertThisInitialized(_this));_this.cancelClick=_this.cancelClick.bind(_assertThisInitialized(_this));return _this;}_createClass(FileUpload,[{key:\"componentDidMount\",value:function componentDidMount(props){var fileObj=JSON.parse(sessionStorage.getItem('uploadedFile'));var studentObj=JSON.parse(sessionStorage.getItem('studentList'));if(fileObj!==null){this.setState({uploadedFile:fileObj});}if(studentObj!==null){this.setState({studentList:studentObj});}}},{key:\"uploadClicked\",value:function uploadClicked(e){if(this.state.uploadedFile===null){this.fileRef.current.click();}else{this.setState({uploadedFile:null,studentList:null});}}},{key:\"onSelectFile\",value:function onSelectFile(e){var _this2=this;e.stopPropagation();e.preventDefault();var file=e.target.files[0];this.setState({uploadedFile:file.name});var schema={'First Name':{prop:'firstName',type:String,required:true},'Last Name':{prop:'lastName',type:String,required:true},'Email':{prop:'email',type:String,required:true}};readXlsxFile(file,{schema:schema}).then(function(_ref){var rows=_ref.rows,errors=_ref.errors;if(errors.length===0){var students=rows.map(function(item){item.studentId=_this2.state.lastIndex;_this2.setState({lastIndex:_this2.state.lastIndex+1});return item;});_this2.setState({studentList:students});}else{alert('Invalid file. Kindly follow file Template!');}});}},{key:\"downloadClicked\",value:function downloadClicked(e){window.location.href=\"\".concat(process.env.PUBLIC_URL,\"/studentList.xlsx\");}},{key:\"cancelClick\",value:function cancelClick(e){this.props.history.push('/classroomSetup');}},{key:\"saveClick\",value:function saveClick(e){sessionStorage.setItem('studentList',JSON.stringify(this.state.studentList));sessionStorage.setItem('uploadedFile',JSON.stringify(this.state.uploadedFile));this.props.history.push('/addStudents');}},{key:\"render\",value:function render(){var token=sessionStorage.getItem('access_token');if(token===null){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}var hideGrid={marginTop:20};var uploadedFile=this.state.uploadedFile;return/*#__PURE__*/React.createElement(\"div\",{className:\"grid\",style:{paddingTop:20}},/*#__PURE__*/React.createElement(Header,{tab:\"file\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"row large-offset-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"columns large-6\",style:hideGrid},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"p\",{style:{fontSize:16}},\"Upload Students information from an excel file (.XLS or .XLSX). Files must adhere to the format shown to the right.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row\",style:hideGrid},/*#__PURE__*/React.createElement(\"t\",{style:uploadedFile===null?{display:\"none\"}:{marginRight:20}},uploadedFile),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",ref:this.fileRef,style:{display:\"none\"},onChange:this.onSelectFile}),/*#__PURE__*/React.createElement(Button,{children:uploadedFile===null?'Upload from file':'Delete',color:\"blue\",onClick:this.uploadClicked,ariaPressed:false}),/*#__PURE__*/React.createElement(Button,{children:\"Download Template\",color:\"blue-outline\",onClick:this.downloadClicked,ariaPressed:false}))),/*#__PURE__*/React.createElement(\"div\",{className:\"columns large-6\",style:hideGrid},/*#__PURE__*/React.createElement(\"img\",{alt:\"fileImageHolder\",src:\"fileImageHolder.png\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row large-offset-1\",style:{marginTop:40,marginLeft:10}},/*#__PURE__*/React.createElement(\"div\",{className:\"large-2 columns\"},/*#__PURE__*/React.createElement(Button,{children:\"Back\",color:\"blue-outline\",onClick:this.cancelClick,style:{color:'blue',borderRadius:5},ariaPressed:false})),/*#__PURE__*/React.createElement(\"div\",{className:\"large-1 columns\"},/*#__PURE__*/React.createElement(Button,{children:\"Continue\",color:\"blue\",onClick:this.saveClick,ariaPressed:false}))));}}]);return FileUpload;}(React.Component);export default FileUpload;","map":{"version":3,"sources":["/Users/pratison/Work/Cisco/Education/React/education-webex/src/pages/FileUpload.js"],"names":["React","readXlsxFile","Button","Redirect","Header","FileUpload","props","state","uploadedFile","studentList","lastIndex","fileRef","createRef","uploadClicked","bind","onSelectFile","saveClick","cancelClick","fileObj","JSON","parse","sessionStorage","getItem","studentObj","setState","e","current","click","stopPropagation","preventDefault","file","target","files","name","schema","prop","type","String","required","then","rows","errors","length","students","map","item","studentId","alert","window","location","href","process","env","PUBLIC_URL","history","push","setItem","stringify","token","hideGrid","marginTop","paddingTop","fontSize","display","marginRight","downloadClicked","marginLeft","color","borderRadius","Component"],"mappings":"q3BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,YAAP,KAAyB,iBAAzB,CACA,OACIC,MADJ,KAEO,oBAFP,CAGA,OACIC,QADJ,KAEO,kBAFP,CAGA,MAAOC,CAAAA,MAAP,KAAmB,aAAnB,C,GAEMC,CAAAA,U,oHACF,oBAAYC,KAAZ,CAAmB,4CACf,uBAAMA,KAAN,EAEA,MAAKC,KAAL,CAAa,CACTC,YAAY,CAAE,IADL,CAETC,WAAW,CAAE,IAFJ,CAGTC,SAAS,CAAE,CAHF,CAAb,CAKA,MAAKC,OAAL,CAAeX,KAAK,CAACY,SAAN,EAAf,CACA,MAAKC,aAAL,CAAqB,MAAKA,aAAL,CAAmBC,IAAnB,+BAArB,CACA,MAAKC,YAAL,CAAoB,MAAKA,YAAL,CAAkBD,IAAlB,+BAApB,CACA,MAAKE,SAAL,CAAiB,MAAKA,SAAL,CAAeF,IAAf,+BAAjB,CACA,MAAKG,WAAL,CAAmB,MAAKA,WAAL,CAAiBH,IAAjB,+BAAnB,CAZe,aAalB,C,mFAEkBR,K,CAAO,CACrB,GAAMY,CAAAA,OAAO,CAAGC,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,cAAvB,CAAX,CAAhB,CACA,GAAMC,CAAAA,UAAU,CAAGJ,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAAX,CAAnB,CACA,GAAIJ,OAAO,GAAK,IAAhB,CAAsB,CAClB,KAAKM,QAAL,CAAc,CAAEhB,YAAY,CAAEU,OAAhB,CAAd,EACH,CACD,GAAIK,UAAU,GAAK,IAAnB,CAAyB,CACrB,KAAKC,QAAL,CAAc,CAAEf,WAAW,CAAEc,UAAf,CAAd,EACH,CACJ,C,oDAEYE,C,CAAG,CACb,GAAI,KAAKlB,KAAL,CAAWC,YAAX,GAA4B,IAAhC,CAAuC,CACnC,KAAKG,OAAL,CAAae,OAAb,CAAqBC,KAArB,GACH,CAFD,IAEO,CACH,KAAKH,QAAL,CAAc,CACVhB,YAAY,CAAE,IADJ,CAEVC,WAAW,CAAE,IAFH,CAAd,EAIH,CACJ,C,kDAEYgB,C,CAAG,iBACZA,CAAC,CAACG,eAAF,GACAH,CAAC,CAACI,cAAF,GACA,GAAIC,CAAAA,IAAI,CAAGL,CAAC,CAACM,MAAF,CAASC,KAAT,CAAe,CAAf,CAAX,CACA,KAAKR,QAAL,CAAc,CACVhB,YAAY,CAAEsB,IAAI,CAACG,IADT,CAAd,EAGA,GAAMC,CAAAA,MAAM,CAAG,CACC,aAAc,CACVC,IAAI,CAAE,WADI,CAEVC,IAAI,CAAEC,MAFI,CAGVC,QAAQ,CAAE,IAHA,CADf,CAMC,YAAa,CACTH,IAAI,CAAE,UADG,CAETC,IAAI,CAAEC,MAFG,CAGTC,QAAQ,CAAE,IAHD,CANd,CAWC,QAAS,CACLH,IAAI,CAAE,OADD,CAELC,IAAI,CAAEC,MAFD,CAGLC,QAAQ,CAAE,IAHL,CAXV,CAAf,CAiBArC,YAAY,CAAC6B,IAAD,CAAO,CAAEI,MAAM,CAANA,MAAF,CAAP,CAAZ,CACCK,IADD,CACM,cAAsB,IAAnBC,CAAAA,IAAmB,MAAnBA,IAAmB,CAAbC,MAAa,MAAbA,MAAa,CACxB,GAAIA,MAAM,CAACC,MAAP,GAAkB,CAAtB,CAAyB,CACrB,GAAMC,CAAAA,QAAQ,CAAGH,IAAI,CAACI,GAAL,CAAS,SAAAC,IAAI,CAAI,CAC9BA,IAAI,CAACC,SAAL,CAAiB,MAAI,CAACvC,KAAL,CAAWG,SAA5B,CACA,MAAI,CAACc,QAAL,CAAc,CAAEd,SAAS,CAAE,MAAI,CAACH,KAAL,CAAWG,SAAX,CAAuB,CAApC,CAAd,EACA,MAAOmC,CAAAA,IAAP,CACH,CAJgB,CAAjB,CAMA,MAAI,CAACrB,QAAL,CAAc,CACZf,WAAW,CAAEkC,QADD,CAAd,EAGH,CAVD,IAUO,CACHI,KAAK,CAAC,4CAAD,CAAL,CACH,CACJ,CAfD,EAgBH,C,wDAEetB,C,CAAG,CACfuB,MAAM,CAACC,QAAP,CAAgBC,IAAhB,WAAwBC,OAAO,CAACC,GAAR,CAAYC,UAApC,sBACH,C,gDAEW5B,C,CAAG,CACX,KAAKnB,KAAL,CAAWgD,OAAX,CAAmBC,IAAnB,CAAwB,iBAAxB,EACH,C,4CAES9B,C,CAAG,CACTJ,cAAc,CAACmC,OAAf,CAAuB,aAAvB,CAAqCrC,IAAI,CAACsC,SAAL,CAAe,KAAKlD,KAAL,CAAWE,WAA1B,CAArC,EACAY,cAAc,CAACmC,OAAf,CAAuB,cAAvB,CAAsCrC,IAAI,CAACsC,SAAL,CAAe,KAAKlD,KAAL,CAAWC,YAA1B,CAAtC,EAEA,KAAKF,KAAL,CAAWgD,OAAX,CAAmBC,IAAnB,CAAwB,cAAxB,EACH,C,uCAEQ,CACL,GAAMG,CAAAA,KAAK,CAAGrC,cAAc,CAACC,OAAf,CAAuB,cAAvB,CAAd,CACA,GAAIoC,KAAK,GAAK,IAAd,CAAoB,CAChB,mBAAO,oBAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAP,CACH,CAED,GAAMC,CAAAA,QAAQ,CAAG,CACbC,SAAS,CAAE,EADE,CAAjB,CAIA,GAAIpD,CAAAA,YAAY,CAAG,KAAKD,KAAL,CAAWC,YAA9B,CAEA,mBACI,2BAAK,SAAS,CAAC,MAAf,CAAsB,KAAK,CAAE,CAACqD,UAAU,CAAC,EAAZ,CAA7B,eACI,oBAAC,MAAD,EAAQ,GAAG,CAAC,MAAZ,EADJ,cAEI,2BAAK,SAAS,CAAC,oBAAf,eACI,2BAAK,SAAS,CAAC,iBAAf,CAAiC,KAAK,CAAEF,QAAxC,eACI,2BAAK,SAAS,CAAC,KAAf,eACI,yBAAG,KAAK,CAAE,CAACG,QAAQ,CAAC,EAAV,CAAV,wHADJ,CADJ,cAKI,2BAAK,SAAS,CAAC,KAAf,CAAqB,KAAK,CAAEH,QAA5B,eACI,yBAAG,KAAK,CAAEnD,YAAY,GAAK,IAAjB,CAAwB,CAACuD,OAAO,CAAE,MAAV,CAAxB,CAA4C,CAACC,WAAW,CAAE,EAAd,CAAtD,EAA0ExD,YAA1E,CADJ,cAEI,6BAAO,IAAI,CAAC,MAAZ,CAAmB,GAAG,CAAE,KAAKG,OAA7B,CAAsC,KAAK,CAAE,CAACoD,OAAO,CAAE,MAAV,CAA7C,CAAgE,QAAQ,CAAE,KAAKhD,YAA/E,EAFJ,cAGI,oBAAC,MAAD,EACI,QAAQ,CAAEP,YAAY,GAAK,IAAjB,CAAwB,kBAAxB,CAA6C,QAD3D,CAEI,KAAK,CAAC,MAFV,CAGI,OAAO,CAAE,KAAKK,aAHlB,CAII,WAAW,CAAE,KAJjB,EAHJ,cASM,oBAAC,MAAD,EACI,QAAQ,CAAC,mBADb,CAEI,KAAK,CAAC,cAFV,CAGI,OAAO,CAAE,KAAKoD,eAHlB,CAII,WAAW,CAAE,KAJjB,EATN,CALJ,CADJ,cAuBI,2BAAK,SAAS,CAAC,iBAAf,CAAiC,KAAK,CAAEN,QAAxC,eACI,2BAAM,GAAG,CAAC,iBAAV,CAA4B,GAAG,CAAC,qBAAhC,EADJ,CAvBJ,CAFJ,cA6BI,2BAAK,SAAS,CAAC,oBAAf,CAAoC,KAAK,CAAE,CAACC,SAAS,CAAC,EAAX,CAAeM,UAAU,CAAC,EAA1B,CAA3C,eACI,2BAAK,SAAS,CAAC,iBAAf,eACI,oBAAC,MAAD,EACI,QAAQ,CAAC,MADb,CAEI,KAAK,CAAC,cAFV,CAGI,OAAO,CAAE,KAAKjD,WAHlB,CAII,KAAK,CAAE,CAACkD,KAAK,CAAC,MAAP,CAAcC,YAAY,CAAC,CAA3B,CAJX,CAKI,WAAW,CAAE,KALjB,EADJ,CADJ,cAUI,2BAAK,SAAS,CAAC,iBAAf,eACI,oBAAC,MAAD,EACI,QAAQ,CAAC,UADb,CAEI,KAAK,CAAC,MAFV,CAGI,OAAO,CAAE,KAAKpD,SAHlB,CAII,WAAW,CAAE,KAJjB,EADJ,CAVJ,CA7BJ,CADJ,CAmDH,C,wBA9JoBhB,KAAK,CAACqE,S,EAiK/B,cAAehE,CAAAA,UAAf","sourcesContent":["import React from 'react';\nimport readXlsxFile from 'read-excel-file'\nimport {\n    Button,\n} from '@momentum-ui/react';\nimport {\n    Redirect,\n} from 'react-router-dom';\nimport Header from './Header.js';\n\nclass FileUpload extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            uploadedFile: null,\n            studentList: null,\n            lastIndex: 1,\n        }\n        this.fileRef = React.createRef();\n        this.uploadClicked = this.uploadClicked.bind(this);\n        this.onSelectFile = this.onSelectFile.bind(this);\n        this.saveClick = this.saveClick.bind(this);\n        this.cancelClick = this.cancelClick.bind(this);\n    }\n\n     componentDidMount(props) {\n         const fileObj = JSON.parse(sessionStorage.getItem('uploadedFile'));\n         const studentObj = JSON.parse(sessionStorage.getItem('studentList'));\n         if (fileObj !== null) {\n             this.setState({ uploadedFile: fileObj });\n         }\n         if (studentObj !== null) {\n             this.setState({ studentList: studentObj });\n         }\n     }\n\n    uploadClicked(e) {\n        if (this.state.uploadedFile === null ) {\n            this.fileRef.current.click();\n        } else {\n            this.setState({\n                uploadedFile: null,\n                studentList: null,\n            });\n        }\n    }\n\n    onSelectFile(e) {\n        e.stopPropagation();\n        e.preventDefault();\n        var file = e.target.files[0];\n        this.setState({\n            uploadedFile: file.name,\n        });\n        const schema = {\n                        'First Name': {\n                            prop: 'firstName',\n                            type: String,\n                            required: true\n                        },\n                        'Last Name': {\n                            prop: 'lastName',\n                            type: String,\n                            required: true\n                        },\n                        'Email': {\n                            prop: 'email',\n                            type: String,\n                            required: true\n                        },\n                    }\n        readXlsxFile(file, { schema })\n        .then(({ rows, errors }) => {\n            if (errors.length === 0) {\n                const students = rows.map(item => {\n                    item.studentId = this.state.lastIndex;\n                    this.setState({ lastIndex: this.state.lastIndex + 1 });\n                    return item;\n                });\n\n                this.setState({\n                  studentList: students\n                });\n            } else {\n                alert('Invalid file. Kindly follow file Template!')\n            }\n        });\n    }\n\n    downloadClicked(e) {\n        window.location.href=`${process.env.PUBLIC_URL}/studentList.xlsx`;\n    }\n\n    cancelClick(e) {\n        this.props.history.push('/classroomSetup');\n    }\n\n    saveClick(e) {\n        sessionStorage.setItem('studentList',JSON.stringify(this.state.studentList));\n        sessionStorage.setItem('uploadedFile',JSON.stringify(this.state.uploadedFile));\n\n        this.props.history.push('/addStudents');\n    }\n\n    render() {\n        const token = sessionStorage.getItem('access_token');\n        if (token === null) {\n            return <Redirect to='/'/>;\n        }\n\n        const hideGrid = {\n            marginTop: 20\n        };\n\n        let uploadedFile = this.state.uploadedFile;\n\n        return (\n            <div className=\"grid\" style={{paddingTop:20}}>\n                <Header tab='file'/>\n                <div className=\"row large-offset-1\">\n                    <div className=\"columns large-6\" style={hideGrid}>\n                        <div className=\"row\">\n                            <p style={{fontSize:16}}>Upload Students information from an excel file (.XLS or .XLSX). Files\n                            must adhere to the format shown to the right.</p>\n                        </div>\n                        <div className=\"row\" style={hideGrid}>\n                            <t style={uploadedFile === null ? {display: \"none\"} : {marginRight: 20}}>{uploadedFile}</t>\n                            <input type=\"file\" ref={this.fileRef} style={{display: \"none\"}} onChange={this.onSelectFile}/>\n                            <Button\n                                children={uploadedFile === null ? 'Upload from file' : 'Delete'}\n                                color='blue'\n                                onClick={this.uploadClicked}\n                                ariaPressed={false}\n                              />\n                              <Button\n                                  children='Download Template'\n                                  color='blue-outline'\n                                  onClick={this.downloadClicked}\n                                  ariaPressed={false}\n                                />\n                         </div>\n                    </div>\n                    <div className=\"columns large-6\" style={hideGrid}>\n                        <img  alt=\"fileImageHolder\" src=\"fileImageHolder.png\"/>\n                    </div>\n                </div>\n                <div className=\"row large-offset-1\" style={{marginTop:40, marginLeft:10}}>\n                    <div className=\"large-2 columns\">\n                        <Button\n                            children='Back'\n                            color='blue-outline'\n                            onClick={this.cancelClick}\n                            style={{color:'blue',borderRadius:5}}\n                            ariaPressed={false}\n                          />\n                    </div>\n                    <div className=\"large-1 columns\">\n                        <Button\n                            children='Continue'\n                            color='blue'\n                            onClick={this.saveClick}\n                            ariaPressed={false}\n                          />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default FileUpload;\n"]},"metadata":{},"sourceType":"module"}