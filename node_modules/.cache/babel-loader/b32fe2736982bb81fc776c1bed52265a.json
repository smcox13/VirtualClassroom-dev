{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _apply = require('babel-runtime/core-js/reflect/apply');\n\nvar _apply2 = _interopRequireDefault(_apply);\n\nvar _promise = require('babel-runtime/core-js/promise');\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _wrap2 = require('lodash/wrap');\n\nvar _wrap3 = _interopRequireDefault(_wrap2);\n\nexports.default = whileInFlight;\n\nvar _tap = require('./tap');\n\nvar _tap2 = _interopRequireDefault(_tap);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\n\n\nfunction whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = (0, _wrap3.default)(descriptor.value, function whileInFlightExecutor(fn) {\n      var _this = this;\n\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return new _promise2.default(function (resolve) {\n        _this[param] = true;\n        resolve((0, _apply2.default)(fn, _this, args).then((0, _tap2.default)(function () {\n          _this[param] = false;\n        })).catch(function (reason) {\n          _this[param] = false;\n          return _promise2.default.reject(reason);\n        }));\n      });\n    });\n  };\n}\n/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint no-invalid-this: [0] */","map":{"version":3,"sources":["while-in-flight.js"],"names":["whileInFlight","descriptor","args","resolve"],"mappings":";;;;;;;;;;;;;;;;;;kBAewBA,a;;AARxB,IAAA,IAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;;;;;;;;AAEA;;;;;;;;AAMe,SAAA,aAAA,CAAA,KAAA,EAA8B;AAC3C,SAAO,SAAA,sBAAA,CAAA,MAAA,EAAA,IAAA,EAAA,UAAA,EAA0D;AAC/DC,IAAAA,UAAAA,CAAAA,KAAAA,GAAmB,CAAA,GAAA,MAAA,CAAA,OAAA,EAAKA,UAAAA,CAAL,KAAA,EAAuB,SAAA,qBAAA,CAAA,EAAA,EAA4C;AAAA,UAAA,KAAA,GAAA,IAAA;;AAAA,WAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAANC,IAAM,GAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;AAANA,QAAAA,IAAM,CAAA,IAAA,GAAA,CAAA,CAANA,GAAM,SAAA,CAAA,IAAA,CAANA;AAAM;;AACpF,aAAO,IAAA,SAAA,CAAA,OAAA,CAAY,UAAA,OAAA,EAAa;AAC9B,QAAA,KAAA,CAAA,KAAA,CAAA,GAAA,IAAA;AACAC,QAAAA,OAAAA,CAAQ,CAAA,GAAA,OAAA,CAAA,OAAA,EAAA,EAAA,EAAA,KAAA,EAAA,IAAA,EAAA,IAAA,CACA,CAAA,GAAA,KAAA,CAAA,OAAA,EAAI,YAAM;AACd,UAAA,KAAA,CAAA,KAAA,CAAA,GAAA,KAAA;AAFI,SACA,CADA,EAAA,KAAA,CAIC,UAAA,MAAA,EAAY;AACjB,UAAA,KAAA,CAAA,KAAA,CAAA,GAAA,KAAA;AAEA,iBAAO,SAAA,CAAA,OAAA,CAAA,MAAA,CAAP,MAAO,CAAP;AAPJA,SAAQ,CAARA,CAAAA;AAFF,OAAO,CAAP;AADFF,KAAmB,CAAnBA;AADF,GAAA;;AAhBF;;;;AAIA","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint no-invalid-this: [0] */\n\nimport {wrap} from 'lodash';\nimport tap from './tap';\n\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\nexport default function whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = wrap(descriptor.value, function whileInFlightExecutor(fn, ...args) {\n      return new Promise((resolve) => {\n        this[param] = true;\n        resolve(Reflect.apply(fn, this, args)\n          .then(tap(() => {\n            this[param] = false;\n          }))\n          .catch((reason) => {\n            this[param] = false;\n\n            return Promise.reject(reason);\n          }));\n      });\n    });\n  };\n}\n"]},"metadata":{},"sourceType":"script"}