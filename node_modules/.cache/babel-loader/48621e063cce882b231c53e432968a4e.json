{"ast":null,"code":"/*!\n * util/databuffer.js - Forge-compatible Buffer based on Node.js Buffers\n *\n * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.\n */\n\"use strict\";\n\nvar forge = require(\"../deps/forge.js\"),\n    base64url = require(\"./base64url.js\");\n/**\n *\n */\n\n\nfunction DataBuffer(b, options) {\n  options = options || {}; // treat (views of) (Array)Buffers special\n  // NOTE: default implementation creates copies, but efficiently\n  //       wherever possible\n\n  if (Buffer.isBuffer(b)) {\n    this.data = b;\n  } else if (forge.util.isArrayBuffer(b)) {\n    b = new Uint8Array(b);\n    this.data = new Buffer(b);\n  } else if (forge.util.isArrayBufferView(b)) {\n    b = new Uint8Array(b.buffer, b.byteOffset, b.byteLength);\n    this.data = new Buffer(b);\n  }\n\n  if (this.data) {\n    this.write = this.data.length;\n    b = undefined;\n  } // setup growth rate\n\n\n  this.growSize = options.growSize || DataBuffer.DEFAULT_GROW_SIZE; // initialize pointers and data\n\n  this.write = this.write || 0;\n  this.read = this.read || 0;\n\n  if (b) {\n    this.putBytes(b);\n  } else if (!this.data) {\n    this.accommodate(0);\n  } // massage read/write pointers\n\n\n  options.readOffset = \"readOffset\" in options ? options.readOffset : this.read;\n  this.write = \"writeOffset\" in options ? options.writeOffset : this.write;\n  this.read = Math.min(options.readOffset, this.write);\n}\n\nDataBuffer.DEFAULT_GROW_SIZE = 16;\n\nDataBuffer.prototype.length = function () {\n  return this.write - this.read;\n};\n\nDataBuffer.prototype.available = function () {\n  return this.data.length - this.write;\n};\n\nDataBuffer.prototype.isEmpty = function () {\n  return this.length() <= 0;\n};\n\nDataBuffer.prototype.accommodate = function (length) {\n  if (!this.data) {\n    // initializes a new buffer\n    length = Math.max(this.write + length, this.growSize);\n    this.data = new Buffer(length);\n  } else if (this.available() < length) {\n    length = Math.max(length, this.growSize); // create a new empty buffer, and copy current one into it\n\n    var src = this.data;\n    var dst = new Buffer(src.length + length);\n    src.copy(dst, 0); // set data as the new buffer\n\n    this.data = dst;\n  } // ensure the rest is 0\n\n\n  this.data.fill(0, this.write);\n  return this;\n};\n\nDataBuffer.prototype.clear = function () {\n  this.read = this.write = 0;\n  this.data = new Buffer(0);\n  return this;\n};\n\nDataBuffer.prototype.truncate = function (count) {\n  // chop off <count> bytes from the end\n  this.write = this.read + Math.max(0, this.length() - count); // ensure the remainder is 0\n\n  this.data.fill(0, this.write);\n  return this;\n};\n\nDataBuffer.prototype.compact = function () {\n  if (this.read > 0) {\n    if (this.write === this.read) {\n      this.read = this.write = 0;\n    } else {\n      this.data.copy(this.data, 0, this.read, this.write);\n      this.write = this.write - this.read;\n      this.read = 0;\n    } // ensure remainder is 0\n\n\n    this.data.fill(0, this.write);\n  }\n\n  return this;\n};\n\nDataBuffer.prototype.copy = function () {\n  return new DataBuffer(this, {\n    readOffset: this.read,\n    writeOffset: this.write,\n    growSize: this.growSize\n  });\n};\n\nDataBuffer.prototype.equals = function (test) {\n  if (!DataBuffer.isBuffer(test)) {\n    return false;\n  }\n\n  if (test.length() !== this.length()) {\n    return false;\n  }\n\n  var rval = true,\n      delta = this.read - test.read; // constant time\n\n  for (var idx = test.read; test.write > idx; idx++) {\n    rval = rval && this.data[idx + delta] === test.data[idx];\n  }\n\n  return rval;\n};\n\nDataBuffer.prototype.at = function (idx) {\n  return this.data[this.read + idx];\n};\n\nDataBuffer.prototype.setAt = function (idx, b) {\n  this.data[this.read + idx] = b;\n  return this;\n};\n\nDataBuffer.prototype.last = function () {\n  return this.data[this.write - 1];\n};\n\nDataBuffer.prototype.bytes = function (count) {\n  var rval;\n\n  if (undefined === count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = \"\";\n  } else {\n    var begin = this.read,\n        end = begin + count,\n        data = this.data.slice(begin, end);\n    rval = String.fromCharCode.apply(null, data);\n  }\n\n  return rval;\n};\n\nDataBuffer.prototype.buffer = function (count) {\n  var rval;\n\n  if (undefined === count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = new ArrayBuffer(0);\n  } else {\n    var begin = this.read,\n        end = begin + count,\n        data = this.data.slice(begin, end);\n    rval = new Uint8Array(end - begin);\n    rval.set(data);\n  }\n\n  return rval;\n};\n\nDataBuffer.prototype.native = function (count) {\n  var rval;\n\n  if (\"undefined\" === typeof count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = new Buffer(0);\n  } else {\n    var begin = this.read,\n        end = begin + count;\n    rval = this.data.slice(begin, end);\n  }\n\n  return rval;\n};\n\nDataBuffer.prototype.toHex = function () {\n  return this.toString(\"hex\");\n};\n\nDataBuffer.prototype.toString = function (encoding) {\n  // short circuit empty string\n  if (0 === this.length()) {\n    return \"\";\n  }\n\n  var view = this.data.slice(this.read, this.write);\n  encoding = encoding || \"utf8\"; // special cases, then built-in support\n\n  switch (encoding) {\n    case \"raw\":\n      return view.toString(\"binary\");\n\n    case \"base64url\":\n      return base64url.encode(view);\n\n    case \"utf16\":\n      return view.toString(\"ucs2\");\n\n    default:\n      return view.toString(encoding);\n  }\n};\n\nDataBuffer.prototype.fillWithByte = function (b, n) {\n  if (!n) {\n    n = this.available();\n  }\n\n  this.accommodate(n);\n  this.data.fill(b, this.write, this.write + n);\n  this.write += n;\n  return this;\n};\n\nDataBuffer.prototype.getBuffer = function (count) {\n  var rval = this.buffer(count);\n  this.read += rval.byteLength;\n  return rval;\n};\n\nDataBuffer.prototype.putBuffer = function (bytes) {\n  return this.putBytes(bytes);\n};\n\nDataBuffer.prototype.getBytes = function (count) {\n  var rval = this.bytes(count);\n  this.read += rval.length;\n  return rval;\n};\n\nDataBuffer.prototype.putBytes = function (bytes, encoding) {\n  if (\"string\" === typeof bytes) {\n    // fixup encoding\n    encoding = encoding || \"binary\";\n\n    switch (encoding) {\n      case \"utf16\":\n        // treat as UCS-2/UTF-16BE\n        encoding = \"ucs-2\";\n        break;\n\n      case \"raw\":\n        encoding = \"binary\";\n        break;\n\n      case \"base64url\":\n        // NOTE: this returns a Buffer\n        bytes = base64url.decode(bytes);\n        break;\n    } // replace bytes with decoded Buffer (if not already)\n\n\n    if (!Buffer.isBuffer(bytes)) {\n      bytes = new Buffer(bytes, encoding);\n    }\n  }\n\n  var src, dst;\n\n  if (bytes instanceof DataBuffer) {\n    // be slightly more efficient\n    var orig = bytes;\n    bytes = orig.data.slice(orig.read, orig.write);\n    orig.read = orig.write;\n  } else if (bytes instanceof forge.util.ByteStringBuffer) {\n    bytes = bytes.getBytes();\n  } // process array\n\n\n  if (Buffer.isBuffer(bytes)) {\n    src = bytes;\n  } else if (Array.isArray(bytes)) {\n    src = new Buffer(bytes);\n  } else if (forge.util.isArrayBuffer(bytes)) {\n    src = new Uint8Array(bytes);\n    src = new Buffer(src);\n  } else if (forge.util.isArrayBufferView(bytes)) {\n    src = bytes instanceof Uint8Array ? bytes : new Uint8Array(bytes.buffer, bytes.byteOffset, bytes.byteLength);\n    src = new Buffer(src);\n  } else {\n    throw new TypeError(\"invalid source type\");\n  }\n\n  this.accommodate(src.length);\n  dst = this.data;\n  src.copy(dst, this.write);\n  this.write += src.length;\n  return this;\n};\n\nDataBuffer.prototype.getNative = function (count) {\n  var rval = this.native(count);\n  this.read += rval.length;\n  return rval;\n};\n\nDataBuffer.prototype.putNative = DataBuffer.prototype.putBuffer;\n\nDataBuffer.prototype.getByte = function () {\n  var b = this.data[this.read];\n  this.read = Math.min(this.read + 1, this.write);\n  return b;\n};\n\nDataBuffer.prototype.putByte = function (b) {\n  this.accommodate(1);\n  this.data[this.write] = b & 0xff;\n  this.write++;\n  return this;\n};\n\nDataBuffer.prototype.getInt16 = function () {\n  var n = this.data[this.read] << 8 ^ this.data[this.read + 1];\n  this.read = Math.min(this.read + 2, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt16 = function (n) {\n  this.accommodate(2);\n  this.data[this.write] = n >>> 8 & 0xff;\n  this.data[this.write + 1] = n & 0xff;\n  this.write += 2;\n  return this;\n};\n\nDataBuffer.prototype.getInt24 = function () {\n  var n = this.data[this.read] << 16 ^ this.data[this.read + 1] << 8 ^ this.data[this.read + 2];\n  this.read = Math.min(this.read + 3, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt24 = function (n) {\n  this.accommodate(3);\n  this.data[this.write] = n >>> 16 & 0xff;\n  this.data[this.write + 1] = n >>> 8 & 0xff;\n  this.data[this.write + 2] = n & 0xff;\n  this.write += 3;\n  return this;\n};\n\nDataBuffer.prototype.getInt32 = function () {\n  var n = this.data[this.read] << 24 ^ this.data[this.read + 1] << 16 ^ this.data[this.read + 2] << 8 ^ this.data[this.read + 3];\n  this.read = Math.min(this.read + 4, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt32 = function (n) {\n  this.accommodate(4);\n  this.data[this.write] = n >>> 24 & 0xff;\n  this.data[this.write + 1] = n >>> 16 & 0xff;\n  this.data[this.write + 2] = n >>> 8 & 0xff;\n  this.data[this.write + 3] = n & 0xff;\n  this.write += 4;\n  return this;\n};\n\nDataBuffer.prototype.getInt16Le = function () {\n  var n = this.data[this.read + 1] << 8 ^ this.data[this.read];\n  this.read = Math.min(this.read + 2, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt16Le = function (n) {\n  this.accommodate(2);\n  this.data[this.write + 1] = n >>> 8 & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 2;\n  return this;\n};\n\nDataBuffer.prototype.getInt24Le = function () {\n  var n = this.data[this.read + 2] << 16 ^ this.data[this.read + 1] << 8 ^ this.data[this.read];\n  this.read = Math.min(this.read + 3, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt24Le = function (n) {\n  this.accommodate(3);\n  this.data[this.write + 2] = n >>> 16 & 0xff;\n  this.data[this.write + 1] = n >>> 8 & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 3;\n  return this;\n};\n\nDataBuffer.prototype.getInt32Le = function () {\n  var n = this.data[this.read + 3] << 24 ^ this.data[this.read + 2] << 16 ^ this.data[this.read + 1] << 8 ^ this.data[this.read];\n  this.read = Math.min(this.read + 4, this.write);\n  return n;\n};\n\nDataBuffer.prototype.putInt32Le = function (n) {\n  this.accommodate(4);\n  this.data[this.write + 3] = n >>> 24 & 0xff;\n  this.data[this.write + 2] = n >>> 16 & 0xff;\n  this.data[this.write + 1] = n >>> 8 & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 4;\n  return this;\n};\n\nDataBuffer.prototype.getInt = function (bits) {\n  var rval = 0;\n\n  do {\n    rval = rval << 8 | this.getByte();\n    bits -= 8;\n  } while (bits > 0);\n\n  return rval;\n};\n\nDataBuffer.prototype.putInt = function (n, bits) {\n  this.accommodate(Math.ceil(bits / 8));\n\n  do {\n    bits -= 8;\n    this.putByte(n >> bits & 0xff);\n  } while (bits > 0);\n\n  return this;\n};\n\nDataBuffer.prototype.putSignedInt = function (n, bits) {\n  if (n < 0) {\n    n += 2 << bits - 1;\n  }\n\n  return this.putInt(n, bits);\n};\n\nDataBuffer.prototype.putString = function (str) {\n  return this.putBytes(str, \"utf16\");\n};\n\nDataBuffer.isBuffer = function (test) {\n  return test instanceof DataBuffer;\n};\n\nDataBuffer.asBuffer = function (orig) {\n  return DataBuffer.isBuffer(orig) ? orig : orig ? new DataBuffer(orig) : new DataBuffer();\n};\n\nmodule.exports = forge.util.ByteBuffer = DataBuffer;","map":{"version":3,"sources":["/Users/pratison/Work/Cisco/Education/React/education-webex/node_modules/node-jose/lib/util/databuffer.js"],"names":["forge","require","base64url","DataBuffer","b","options","Buffer","isBuffer","data","util","isArrayBuffer","Uint8Array","isArrayBufferView","buffer","byteOffset","byteLength","write","length","undefined","growSize","DEFAULT_GROW_SIZE","read","putBytes","accommodate","readOffset","writeOffset","Math","min","prototype","available","isEmpty","max","src","dst","copy","fill","clear","truncate","count","compact","equals","test","rval","delta","idx","at","setAt","last","bytes","begin","end","slice","String","fromCharCode","apply","ArrayBuffer","set","native","toHex","toString","encoding","view","encode","fillWithByte","n","getBuffer","putBuffer","getBytes","decode","orig","ByteStringBuffer","Array","isArray","TypeError","getNative","putNative","getByte","putByte","getInt16","putInt16","getInt24","putInt24","getInt32","putInt32","getInt16Le","putInt16Le","getInt24Le","putInt24Le","getInt32Le","putInt32Le","getInt","bits","putInt","ceil","putSignedInt","putString","str","asBuffer","module","exports","ByteBuffer"],"mappings":"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","sourcesContent":["/*!\n * util/databuffer.js - Forge-compatible Buffer based on Node.js Buffers\n *\n * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.\n */\n\"use strict\";\n\nvar forge = require(\"../deps/forge.js\"),\n    base64url = require(\"./base64url.js\");\n\n/**\n *\n */\nfunction DataBuffer(b, options) {\n  options = options || {};\n\n  // treat (views of) (Array)Buffers special\n  // NOTE: default implementation creates copies, but efficiently\n  //       wherever possible\n  if (Buffer.isBuffer(b)) {\n    this.data = b;\n  } else if (forge.util.isArrayBuffer(b)) {\n    b = new Uint8Array(b);\n    this.data = new Buffer(b);\n  } else if (forge.util.isArrayBufferView(b)) {\n    b = new Uint8Array(b.buffer, b.byteOffset, b.byteLength);\n    this.data = new Buffer(b);\n  }\n\n  if (this.data) {\n    this.write = this.data.length;\n    b = undefined;\n  }\n\n  // setup growth rate\n  this.growSize = options.growSize || DataBuffer.DEFAULT_GROW_SIZE;\n\n  // initialize pointers and data\n  this.write = this.write || 0;\n  this.read = this.read || 0;\n  if (b) {\n    this.putBytes(b);\n  } else if (!this.data) {\n    this.accommodate(0);\n  }\n\n  // massage read/write pointers\n  options.readOffset = (\"readOffset\" in options) ?\n                       options.readOffset :\n                       this.read;\n  this.write = (\"writeOffset\" in options) ?\n               options.writeOffset :\n               this.write;\n  this.read = Math.min(options.readOffset, this.write);\n}\nDataBuffer.DEFAULT_GROW_SIZE = 16;\n\nDataBuffer.prototype.length = function() {\n  return this.write - this.read;\n};\nDataBuffer.prototype.available = function() {\n  return this.data.length - this.write;\n};\nDataBuffer.prototype.isEmpty = function() {\n  return this.length() <= 0;\n};\n\nDataBuffer.prototype.accommodate = function(length) {\n  if (!this.data) {\n    // initializes a new buffer\n    length = Math.max(this.write + length, this.growSize);\n\n    this.data = new Buffer(length);\n  } else if (this.available() < length) {\n    length = Math.max(length, this.growSize);\n\n    // create a new empty buffer, and copy current one into it\n    var src = this.data;\n    var dst = new Buffer(src.length + length);\n    src.copy(dst, 0);\n\n    // set data as the new buffer\n    this.data = dst;\n  }\n  // ensure the rest is 0\n  this.data.fill(0, this.write);\n\n  return this;\n};\nDataBuffer.prototype.clear = function() {\n  this.read = this.write = 0;\n  this.data = new Buffer(0);\n  return this;\n};\nDataBuffer.prototype.truncate = function(count) {\n  // chop off <count> bytes from the end\n  this.write = this.read + Math.max(0, this.length() - count);\n  // ensure the remainder is 0\n  this.data.fill(0, this.write);\n  return this;\n};\nDataBuffer.prototype.compact = function() {\n  if (this.read > 0) {\n    if (this.write === this.read) {\n      this.read = this.write = 0;\n    } else {\n      this.data.copy(this.data, 0, this.read, this.write);\n      this.write = this.write - this.read;\n      this.read = 0;\n    }\n    // ensure remainder is 0\n    this.data.fill(0, this.write);\n  }\n  return this;\n};\nDataBuffer.prototype.copy = function() {\n  return new DataBuffer(this, {\n    readOffset: this.read,\n    writeOffset: this.write,\n    growSize: this.growSize\n  });\n};\n\nDataBuffer.prototype.equals = function(test) {\n  if (!DataBuffer.isBuffer(test)) {\n    return false;\n  }\n\n  if (test.length() !== this.length()) {\n    return false;\n  }\n\n  var rval = true,\n      delta = this.read - test.read;\n  // constant time\n  for (var idx = test.read; test.write > idx; idx++) {\n    rval = rval && (this.data[idx + delta] === test.data[idx]);\n  }\n  return rval;\n};\nDataBuffer.prototype.at = function(idx) {\n  return this.data[this.read + idx];\n};\nDataBuffer.prototype.setAt = function(idx, b) {\n  this.data[this.read + idx] = b;\n  return this;\n};\nDataBuffer.prototype.last = function() {\n  return this.data[this.write - 1];\n};\nDataBuffer.prototype.bytes = function(count) {\n  var rval;\n  if (undefined === count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = \"\";\n  } else {\n    var begin = this.read,\n        end = begin + count,\n        data = this.data.slice(begin, end);\n    rval = String.fromCharCode.apply(null, data);\n  }\n\n  return rval;\n};\nDataBuffer.prototype.buffer = function(count) {\n  var rval;\n  if (undefined === count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = new ArrayBuffer(0);\n  } else {\n    var begin = this.read,\n        end = begin + count,\n        data = this.data.slice(begin, end);\n    rval = new Uint8Array(end - begin);\n    rval.set(data);\n  }\n\n  return rval;\n};\nDataBuffer.prototype.native = function(count) {\n  var rval;\n  if (\"undefined\" === typeof count) {\n    count = this.length();\n  } else if (count) {\n    count = Math.min(count, this.length());\n  }\n\n  if (0 === count) {\n    rval = new Buffer(0);\n  } else {\n    var begin = this.read,\n        end = begin + count;\n    rval = this.data.slice(begin, end);\n  }\n\n  return rval;\n};\n\nDataBuffer.prototype.toHex = function() {\n  return this.toString(\"hex\");\n};\nDataBuffer.prototype.toString = function(encoding) {\n  // short circuit empty string\n  if (0 === this.length()) {\n    return \"\";\n  }\n\n  var view = this.data.slice(this.read, this.write);\n  encoding = encoding || \"utf8\";\n  // special cases, then built-in support\n  switch (encoding) {\n    case \"raw\":\n      return view.toString(\"binary\");\n    case \"base64url\":\n      return base64url.encode(view);\n    case \"utf16\":\n      return view.toString(\"ucs2\");\n    default:\n      return view.toString(encoding);\n  }\n};\n\nDataBuffer.prototype.fillWithByte = function(b, n) {\n  if (!n) {\n    n = this.available();\n  }\n  this.accommodate(n);\n  this.data.fill(b, this.write, this.write + n);\n  this.write += n;\n\n  return this;\n};\n\nDataBuffer.prototype.getBuffer = function(count) {\n  var rval = this.buffer(count);\n  this.read += rval.byteLength;\n\n  return rval;\n};\nDataBuffer.prototype.putBuffer = function(bytes) {\n  return this.putBytes(bytes);\n};\n\nDataBuffer.prototype.getBytes = function(count) {\n  var rval = this.bytes(count);\n  this.read += rval.length;\n  return rval;\n};\nDataBuffer.prototype.putBytes = function(bytes, encoding) {\n  if (\"string\" === typeof bytes) {\n    // fixup encoding\n    encoding = encoding || \"binary\";\n    switch (encoding) {\n      case \"utf16\":\n        // treat as UCS-2/UTF-16BE\n        encoding = \"ucs-2\";\n        break;\n      case \"raw\":\n        encoding = \"binary\";\n        break;\n      case \"base64url\":\n        // NOTE: this returns a Buffer\n        bytes = base64url.decode(bytes);\n        break;\n    }\n\n    // replace bytes with decoded Buffer (if not already)\n    if (!Buffer.isBuffer(bytes)) {\n      bytes = new Buffer(bytes, encoding);\n    }\n  }\n\n  var src, dst;\n  if (bytes instanceof DataBuffer) {\n    // be slightly more efficient\n    var orig = bytes;\n    bytes = orig.data.slice(orig.read, orig.write);\n    orig.read = orig.write;\n  } else if (bytes instanceof forge.util.ByteStringBuffer) {\n    bytes = bytes.getBytes();\n  }\n\n  // process array\n  if (Buffer.isBuffer(bytes)) {\n    src = bytes;\n  } else if (Array.isArray(bytes)) {\n    src = new Buffer(bytes);\n  } else if (forge.util.isArrayBuffer(bytes)) {\n    src = new Uint8Array(bytes);\n    src = new Buffer(src);\n  } else if (forge.util.isArrayBufferView(bytes)) {\n    src = (bytes instanceof Uint8Array) ?\n              bytes :\n              new Uint8Array(bytes.buffer,\n                             bytes.byteOffset,\n                             bytes.byteLength);\n    src = new Buffer(src);\n  } else {\n    throw new TypeError(\"invalid source type\");\n  }\n\n  this.accommodate(src.length);\n  dst = this.data;\n  src.copy(dst, this.write);\n  this.write += src.length;\n\n  return this;\n};\n\nDataBuffer.prototype.getNative = function(count) {\n  var rval = this.native(count);\n  this.read += rval.length;\n  return rval;\n};\nDataBuffer.prototype.putNative = DataBuffer.prototype.putBuffer;\n\nDataBuffer.prototype.getByte = function() {\n  var b = this.data[this.read];\n  this.read = Math.min(this.read + 1, this.write);\n  return b;\n};\nDataBuffer.prototype.putByte = function(b) {\n  this.accommodate(1);\n  this.data[this.write] = b & 0xff;\n  this.write++;\n\n  return this;\n};\n\nDataBuffer.prototype.getInt16 = function() {\n  var n = (this.data[this.read] << 8) ^\n          (this.data[this.read + 1]);\n  this.read = Math.min(this.read + 2, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt16 = function(n) {\n  this.accommodate(2);\n  this.data[this.write] = (n >>> 8) & 0xff;\n  this.data[this.write + 1] = n & 0xff;\n  this.write += 2;\n  return this;\n};\n\nDataBuffer.prototype.getInt24 = function() {\n  var n = (this.data[this.read] << 16) ^\n          (this.data[this.read + 1] << 8) ^\n          this.data[this.read + 2];\n  this.read = Math.min(this.read + 3, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt24 = function(n) {\n  this.accommodate(3);\n  this.data[this.write] = (n >>> 16) & 0xff;\n  this.data[this.write + 1] = (n >>> 8) & 0xff;\n  this.data[this.write + 2] = n & 0xff;\n  this.write += 3;\n  return this;\n};\n\nDataBuffer.prototype.getInt32 = function() {\n  var n = (this.data[this.read] << 24) ^\n          (this.data[this.read + 1] << 16) ^\n          (this.data[this.read + 2] << 8) ^\n          this.data[this.read + 3];\n  this.read = Math.min(this.read + 4, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt32 = function(n) {\n  this.accommodate(4);\n  this.data[this.write] = (n >>> 24) & 0xff;\n  this.data[this.write + 1] = (n >>> 16) & 0xff;\n  this.data[this.write + 2] = (n >>> 8) & 0xff;\n  this.data[this.write + 3] = n & 0xff;\n  this.write += 4;\n  return this;\n};\n\nDataBuffer.prototype.getInt16Le = function() {\n  var n = (this.data[this.read + 1] << 8) ^\n          this.data[this.read];\n  this.read = Math.min(this.read + 2, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt16Le = function(n) {\n  this.accommodate(2);\n  this.data[this.write + 1] = (n >>> 8) & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 2;\n  return this;\n};\n\nDataBuffer.prototype.getInt24Le = function() {\n  var n = (this.data[this.read + 2] << 16) ^\n          (this.data[this.read + 1] << 8) ^\n          this.data[this.read];\n  this.read = Math.min(this.read + 3, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt24Le = function(n) {\n  this.accommodate(3);\n  this.data[this.write + 2] = (n >>> 16) & 0xff;\n  this.data[this.write + 1] = (n >>> 8) & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 3;\n  return this;\n};\nDataBuffer.prototype.getInt32Le = function() {\n  var n = (this.data[this.read + 3] << 24) ^\n          (this.data[this.read + 2] << 16) ^\n          (this.data[this.read + 1] << 8) ^\n          this.data[this.read];\n  this.read = Math.min(this.read + 4, this.write);\n  return n;\n};\nDataBuffer.prototype.putInt32Le = function(n) {\n  this.accommodate(4);\n  this.data[this.write + 3] = (n >>> 24) & 0xff;\n  this.data[this.write + 2] = (n >>> 16) & 0xff;\n  this.data[this.write + 1] = (n >>> 8) & 0xff;\n  this.data[this.write] = n & 0xff;\n  this.write += 4;\n  return this;\n};\n\nDataBuffer.prototype.getInt = function(bits) {\n  var rval = 0;\n  do {\n    rval = (rval << 8) | this.getByte();\n    bits -= 8;\n  } while (bits > 0);\n  return rval;\n};\nDataBuffer.prototype.putInt = function(n, bits) {\n  this.accommodate(Math.ceil(bits / 8));\n  do {\n    bits -= 8;\n    this.putByte((n >> bits) & 0xff);\n  } while (bits > 0);\n  return this;\n};\n\nDataBuffer.prototype.putSignedInt = function(n, bits) {\n  if (n < 0) {\n    n += 2 << (bits - 1);\n  }\n  return this.putInt(n, bits);\n};\n\nDataBuffer.prototype.putString = function(str) {\n  return this.putBytes(str, \"utf16\");\n};\n\nDataBuffer.isBuffer = function(test) {\n  return (test instanceof DataBuffer);\n};\nDataBuffer.asBuffer = function(orig) {\n  return DataBuffer.isBuffer(orig) ?\n         orig :\n         orig ?\n         new DataBuffer(orig) :\n         new DataBuffer();\n};\n\nmodule.exports = forge.util.ByteBuffer = DataBuffer;\n"]},"metadata":{},"sourceType":"script"}