{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _keys = require('babel-runtime/core-js/object/keys');\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _promise = require('babel-runtime/core-js/promise');\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _webexCore = require('@webex/webex-core');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * @class\n */\n\n\nvar AbstractUserUUIDRequestBatcher = _webexCore.Batcher.extend({\n  namespace: 'User',\n\n  /**\n   * @param {string} item\n   * @returns {Promise<Object>}\n   */\n  prepareItem: function prepareItem(item) {\n    return _promise2.default.resolve({\n      email: item\n    });\n  },\n\n  /**\n   * @param {HttpResponseObject} res\n   * @returns {Promise}\n   */\n  handleHttpSuccess: function handleHttpSuccess(res) {\n    var _this = this;\n\n    return _promise2.default.all((0, _keys2.default)(res.body).map(function (email) {\n      if (res.body[email] && res.body[email].id) {\n        return _this.handleItemSuccess(email, res.body[email]);\n      }\n\n      return _this.handleItemFailure(email, res.body[email]);\n    }));\n  },\n  handleItemFailure: function handleItemFailure(email, response) {\n    return this.getDeferredForResponse(email).then(function (defer) {\n      defer.reject(response);\n    });\n  },\n\n  /**\n   * @param {string} email\n   * @param {Object} response\n   * @returns {Promise}\n   */\n  handleItemSuccess: function handleItemSuccess(email, response) {\n    return this.getDeferredForResponse(email).then(function (defer) {\n      defer.resolve(response);\n    });\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintRequest: function fingerprintRequest(email) {\n    return _promise2.default.resolve(email.email || email);\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintResponse: function fingerprintResponse(email) {\n    return _promise2.default.resolve(email);\n  }\n});\n/**\n * @class\n */\n\n/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\n\nvar FakeUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest: function submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload\n    });\n  }\n});\n/**\n * @class\n */\n\nvar RealUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest: function submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload,\n      qs: {\n        shouldCreateUsers: true\n      }\n    });\n  }\n});\n/**\n * @class\n */\n\nvar UserUUIDBatcher = _webexCore.WebexPlugin.extend({\n  children: {\n    faker: FakeUserUUIDRequestBatcher,\n    creator: RealUserUUIDRequestBatcher\n  },\n\n  /**\n   * @param {Object} payload\n   * @returns {Promise<Object>}\n   */\n  request: function request(payload) {\n    return payload.create ? this.creator.request(payload.email) : this.faker.request(payload.email);\n  },\n  version: '1.80.172'\n});\n\nexports.default = UserUUIDBatcher;","map":{"version":3,"sources":["user-uuid-batcher.js"],"names":["AbstractUserUUIDRequestBatcher","namespace","prepareItem","email","handleHttpSuccess","res","handleItemFailure","defer","handleItemSuccess","fingerprintRequest","fingerprintResponse","FakeUserUUIDRequestBatcher","submitHttpRequest","method","service","resource","body","payload","RealUserUUIDRequestBatcher","qs","shouldCreateUsers","UserUUIDBatcher","children","faker","creator","request"],"mappings":";;;;;;;;;;;;;;AAIA,IAAA,UAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;;;;;;AAEA;;;;;AAGA,IAAMA,8BAAAA,GAAiC,UAAA,CAAA,OAAA,CAAA,MAAA,CAAe;AACpDC,EAAAA,SAAAA,EADoD,MAAA;;AAGpD;;;;AAIAC,EAAAA,WAPoD,EAAA,SAAA,WAAA,CAAA,IAAA,EAOlC;AAChB,WAAO,SAAA,CAAA,OAAA,CAAA,OAAA,CAAgB;AAACC,MAAAA,KAAAA,EAAxB;AAAuB,KAAhB,CAAP;AARkD,GAAA;;AAWpD;;;;AAIAC,EAAAA,iBAfoD,EAAA,SAAA,iBAAA,CAAA,GAAA,EAe7B;AAAA,QAAA,KAAA,GAAA,IAAA;;AACrB,WAAO,SAAA,CAAA,OAAA,CAAA,GAAA,CAAY,CAAA,GAAA,MAAA,CAAA,OAAA,EAAYC,GAAAA,CAAZ,IAAA,EAAA,GAAA,CAA0B,UAAA,KAAA,EAAW;AACtD,UAAIA,GAAAA,CAAAA,IAAAA,CAAAA,KAAAA,KAAmBA,GAAAA,CAAAA,IAAAA,CAAAA,KAAAA,EAAvB,EAAA,EAA2C;AACzC,eAAO,KAAA,CAAA,iBAAA,CAAA,KAAA,EAA8BA,GAAAA,CAAAA,IAAAA,CAArC,KAAqCA,CAA9B,CAAP;AACD;;AAED,aAAO,KAAA,CAAA,iBAAA,CAAA,KAAA,EAA8BA,GAAAA,CAAAA,IAAAA,CAArC,KAAqCA,CAA9B,CAAP;AALF,KAAmB,CAAZ,CAAP;AAhBkD,GAAA;AAyBpDC,EAAAA,iBAzBoD,EAAA,SAAA,iBAAA,CAAA,KAAA,EAAA,QAAA,EAyBjB;AACjC,WAAO,KAAA,sBAAA,CAAA,KAAA,EAAA,IAAA,CACC,UAAA,KAAA,EAAW;AACfC,MAAAA,KAAAA,CAAAA,MAAAA,CAAAA,QAAAA;AAFJ,KAAO,CAAP;AA1BkD,GAAA;;AAgCpD;;;;;AAKAC,EAAAA,iBArCoD,EAAA,SAAA,iBAAA,CAAA,KAAA,EAAA,QAAA,EAqCjB;AACjC,WAAO,KAAA,sBAAA,CAAA,KAAA,EAAA,IAAA,CACC,UAAA,KAAA,EAAW;AACfD,MAAAA,KAAAA,CAAAA,OAAAA,CAAAA,QAAAA;AAFJ,KAAO,CAAP;AAtCkD,GAAA;;AA4CpD;;;;AAIAE,EAAAA,kBAhDoD,EAAA,SAAA,kBAAA,CAAA,KAAA,EAgD1B;AACxB,WAAO,SAAA,CAAA,OAAA,CAAA,OAAA,CAAgBN,KAAAA,CAAAA,KAAAA,IAAvB,KAAO,CAAP;AAjDkD,GAAA;;AAoDpD;;;;AAIAO,EAAAA,mBAxDoD,EAAA,SAAA,mBAAA,CAAA,KAAA,EAwDzB;AACzB,WAAO,SAAA,CAAA,OAAA,CAAA,OAAA,CAAP,KAAO,CAAP;AACD;AA1DmD,CAAf,CAAvC;AA6DA;;;;AAtEA;;;;;AAyEA,IAAMC,0BAAAA,GAA6B,8BAAA,CAAA,MAAA,CAAsC;AACvE;;;;AAIAC,EAAAA,iBALuE,EAAA,SAAA,iBAAA,CAAA,OAAA,EAK5C;AACzB,WAAO,KAAA,KAAA,CAAA,OAAA,CAAmB;AACxBC,MAAAA,MAAAA,EADwB,MAAA;AAExBC,MAAAA,OAAAA,EAFwB,cAAA;AAGxBC,MAAAA,QAAAA,EAHwB,QAAA;AAIxBC,MAAAA,IAAAA,EAAMC;AAJkB,KAAnB,CAAP;AAMD;AAZsE,CAAtC,CAAnC;AAeA;;;;AAGA,IAAMC,0BAAAA,GAA6B,8BAAA,CAAA,MAAA,CAAsC;AACvE;;;;AAIAN,EAAAA,iBALuE,EAAA,SAAA,iBAAA,CAAA,OAAA,EAK5C;AACzB,WAAO,KAAA,KAAA,CAAA,OAAA,CAAmB;AACxBC,MAAAA,MAAAA,EADwB,MAAA;AAExBC,MAAAA,OAAAA,EAFwB,cAAA;AAGxBC,MAAAA,QAAAA,EAHwB,QAAA;AAIxBC,MAAAA,IAAAA,EAJwB,OAAA;AAKxBG,MAAAA,EAAAA,EAAI;AACFC,QAAAA,iBAAAA,EAAmB;AADjB;AALoB,KAAnB,CAAP;AASD;AAfsE,CAAtC,CAAnC;AAkBA;;;;AAGA,IAAMC,eAAAA,GAAkB,UAAA,CAAA,WAAA,CAAA,MAAA,CAAmB;AACzCC,EAAAA,QAAAA,EAAU;AACRC,IAAAA,KAAAA,EADQ,0BAAA;AAERC,IAAAA,OAAAA,EAASN;AAFD,GAD+B;;AAMzC;;;;AAIAO,EAAAA,OAVyC,EAAA,SAAA,OAAA,CAAA,OAAA,EAUxB;AACf,WAAOR,OAAAA,CAAAA,MAAAA,GAAiB,KAAA,OAAA,CAAA,OAAA,CAAqBA,OAAAA,CAAtCA,KAAiB,CAAjBA,GAAuD,KAAA,KAAA,CAAA,OAAA,CAAmBA,OAAAA,CAAjF,KAA8D,CAA9D;AAXuC,GAAA;AAAA,EAAA,OAAA,EAAA;AAAA,CAAnB,CAAxB;;kBAeeI,e","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Batcher, WebexPlugin} from '@webex/webex-core';\n\n/**\n * @class\n */\nconst AbstractUserUUIDRequestBatcher = Batcher.extend({\n  namespace: 'User',\n\n  /**\n   * @param {string} item\n   * @returns {Promise<Object>}\n   */\n  prepareItem(item) {\n    return Promise.resolve({email: item});\n  },\n\n  /**\n   * @param {HttpResponseObject} res\n   * @returns {Promise}\n   */\n  handleHttpSuccess(res) {\n    return Promise.all(Object.keys(res.body).map((email) => {\n      if (res.body[email] && res.body[email].id) {\n        return this.handleItemSuccess(email, res.body[email]);\n      }\n\n      return this.handleItemFailure(email, res.body[email]);\n    }));\n  },\n\n  handleItemFailure(email, response) {\n    return this.getDeferredForResponse(email)\n      .then((defer) => {\n        defer.reject(response);\n      });\n  },\n\n  /**\n   * @param {string} email\n   * @param {Object} response\n   * @returns {Promise}\n   */\n  handleItemSuccess(email, response) {\n    return this.getDeferredForResponse(email)\n      .then((defer) => {\n        defer.resolve(response);\n      });\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintRequest(email) {\n    return Promise.resolve(email.email || email);\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintResponse(email) {\n    return Promise.resolve(email);\n  }\n});\n\n/**\n * @class\n */\nconst FakeUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload\n    });\n  }\n});\n\n/**\n * @class\n */\nconst RealUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload,\n      qs: {\n        shouldCreateUsers: true\n      }\n    });\n  }\n});\n\n/**\n * @class\n */\nconst UserUUIDBatcher = WebexPlugin.extend({\n  children: {\n    faker: FakeUserUUIDRequestBatcher,\n    creator: RealUserUUIDRequestBatcher\n  },\n\n  /**\n   * @param {Object} payload\n   * @returns {Promise<Object>}\n   */\n  request(payload) {\n    return payload.create ? this.creator.request(payload.email) : this.faker.request(payload.email);\n  }\n});\n\nexport default UserUUIDBatcher;\n"]},"metadata":{},"sourceType":"script"}