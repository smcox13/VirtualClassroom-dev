{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _promise = require('babel-runtime/core-js/promise');\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _defineProperties = require('babel-runtime/core-js/object/define-properties');\n\nvar _defineProperties2 = _interopRequireDefault(_defineProperties);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _httpError = require('../http-error');\n\nvar _httpError2 = _interopRequireDefault(_httpError);\n\nvar _interceptor = require('../lib/interceptor');\n\nvar _interceptor2 = _interopRequireDefault(_interceptor);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\n\nvar LOCUS_REDIRECT_ERROR = 2000002;\n/**\n * @class\n */\n\nvar HttpStatusInterceptor = function (_Interceptor) {\n  (0, _inherits3.default)(HttpStatusInterceptor, _Interceptor);\n  /**\n   * @param {Object} webex\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n\n  function HttpStatusInterceptor(webex, options) {\n    (0, _classCallCheck3.default)(this, HttpStatusInterceptor);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (HttpStatusInterceptor.__proto__ || (0, _getPrototypeOf2.default)(HttpStatusInterceptor)).call(this, webex));\n\n    var ErrorConstructor = options && (options.error || options.ErrorConstructor) || _httpError2.default;\n    (0, _defineProperties2.default)(_this, {\n      ErrorConstructor: {\n        value: ErrorConstructor\n      }\n    });\n    return _this;\n  }\n  /**\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n\n\n  (0, _createClass3.default)(HttpStatusInterceptor, [{\n    key: 'onResponse',\n\n    /**\n     * @param {Object} options\n     * @param {HttpResponse} response\n     * @returns {Promise}\n     */\n    value: function onResponse(options, response) {\n      if (response.statusCode) {\n        if (response.statusCode < 400) {\n          return _promise2.default.resolve(response);\n        } // to handle locus redirects\n\n\n        if (response.statusCode === 404 && response.body && response.body.errorCode === LOCUS_REDIRECT_ERROR) {\n          return _promise2.default.resolve(response);\n        }\n      } // Note: the extra parenthesis below are required to make sure `new` is\n      // applied to the correct method (i.e., the result of `select()`, not\n      // `select()` itself).\n\n\n      return _promise2.default.reject(new (this.ErrorConstructor.select(response.statusCode))(response));\n    }\n  }], [{\n    key: 'create',\n    value: function create(options) {\n      return new HttpStatusInterceptor(this, options);\n    }\n  }]);\n  return HttpStatusInterceptor;\n}(_interceptor2.default);\n\nexports.default = HttpStatusInterceptor;","map":{"version":3,"sources":["http-status.js"],"names":["LOCUS_REDIRECT_ERROR","HttpStatusInterceptor","Interceptor","ErrorConstructor","options","HttpError","value","response"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAA,UAAA,GAAA,OAAA,CAAA,eAAA,CAAA;;;;AACA,IAAA,YAAA,GAAA,OAAA,CAAA,oBAAA,CAAA;;;;;;;;;AALA;;;;;AAOA,IAAMA,oBAAAA,GAAN,OAAA;AAEA;;;;IAGqBC,qB;;AACnB;;;;;;AAKA,WAAA,qBAAA,CAAA,KAAA,EAAA,OAAA,EAA4B;AAAA,KAAA,GAAA,gBAAA,CAAA,OAAA,EAAA,IAAA,EAAA,qBAAA;;AAAA,QAAA,KAAA,GAAA,CAAA,GAAA,2BAAA,CAAA,OAAA,EAAA,IAAA,EAAA,CAAA,qBAAA,CAAA,SAAA,IAAA,CAAA,GAAA,gBAAA,CAAA,OAAA,EAAA,qBAAA,CAAA,EAAA,IAAA,CAAA,IAAA,EAAA,KAAA,CAAA,CAAA;;AAE1B,QAAME,gBAAAA,GAAmBC,OAAAA,KAAYA,OAAAA,CAAAA,KAAAA,IAAiBA,OAAAA,CAA7BA,gBAAAA,CAAAA,IAA0DC,WAAAA,CAAnF,OAAA;AAEA,KAAA,GAAA,kBAAA,CAAA,OAAA,EAAA,KAAA,EAA8B;AAC5BF,MAAAA,gBAAAA,EAAkB;AAChBG,QAAAA,KAAAA,EAAOH;AADS;AADU,KAA9B;AAJ0B,WAAA,KAAA;AAS3B;AAED;;;;;;;;;AAQA;;;;;+BAKWC,O,EAASG,Q,EAAU;AAC5B,UAAIA,QAAAA,CAAJ,UAAA,EAAyB;AACvB,YAAIA,QAAAA,CAAAA,UAAAA,GAAJ,GAAA,EAA+B;AAC7B,iBAAO,SAAA,CAAA,OAAA,CAAA,OAAA,CAAP,QAAO,CAAP;AACD,SAHsB,CAIvB;;;AACA,YAAIA,QAAAA,CAAAA,UAAAA,KAAAA,GAAAA,IACFA,QAAAA,CADEA,IAAAA,IAEFA,QAAAA,CAAAA,IAAAA,CAAAA,SAAAA,KAFF,oBAAA,EAEoD;AAClD,iBAAO,SAAA,CAAA,OAAA,CAAA,OAAA,CAAP,QAAO,CAAP;AACD;AACF,OAX2B,CAa5B;AACA;AACA;;;AACA,aAAO,SAAA,CAAA,OAAA,CAAA,MAAA,CAAe,KAAK,KAAA,gBAAA,CAAA,MAAA,CAA6BA,QAAAA,CAAlC,UAAK,CAAL,EAAtB,QAAsB,CAAf,CAAP;AACD;;;2BA1BaH,O,EAAS;AACrB,aAAO,IAAA,qBAAA,CAAA,IAAA,EAAP,OAAO,CAAP;AACD;;;EAvBgDF,aAAAA,CAAAA,O;;kBAA9BD,qB","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport HttpError from '../http-error';\nimport Interceptor from '../lib/interceptor';\n\nconst LOCUS_REDIRECT_ERROR = 2000002;\n\n/**\n * @class\n */\nexport default class HttpStatusInterceptor extends Interceptor {\n  /**\n   * @param {Object} webex\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  constructor(webex, options) {\n    super(webex);\n    const ErrorConstructor = options && (options.error || options.ErrorConstructor) || HttpError;\n\n    Object.defineProperties(this, {\n      ErrorConstructor: {\n        value: ErrorConstructor\n      }\n    });\n  }\n\n  /**\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  static create(options) {\n    return new HttpStatusInterceptor(this, options);\n  }\n\n  /**\n   * @param {Object} options\n   * @param {HttpResponse} response\n   * @returns {Promise}\n   */\n  onResponse(options, response) {\n    if (response.statusCode) {\n      if (response.statusCode < 400) {\n        return Promise.resolve(response);\n      }\n      // to handle locus redirects\n      if (response.statusCode === 404 &&\n        response.body &&\n        response.body.errorCode === LOCUS_REDIRECT_ERROR) {\n        return Promise.resolve(response);\n      }\n    }\n\n    // Note: the extra parenthesis below are required to make sure `new` is\n    // applied to the correct method (i.e., the result of `select()`, not\n    // `select()` itself).\n    return Promise.reject(new (this.ErrorConstructor.select(response.statusCode))(response));\n  }\n}\n"]},"metadata":{},"sourceType":"script"}